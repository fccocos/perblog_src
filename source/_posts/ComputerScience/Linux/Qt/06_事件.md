## 事件处理机制

事件（event)是由系统或者Qt本身在不同的时刻发出的。当用户按下鼠标、敲下键盘，或者是窗口需要重新制的时候，都会发出一个相应的事件。

一些事件在对用户操作做出响应付发出，如键盘事件等；另一些事件则是由系统自动发出，如计时器事件。

事件处理过程：

1)在Qt内部，Qt通过QApplication:exec()启动的主事件循环不停的抓取事件队列中的事件。

2)当事件发生时，Qt将创建一个事件对象。Qt中所有事件类都继承于QEvent。

3)在事件对象创建完毕后，Qt将这个事件对象传递给QObject的event()函数。event()函数并不直接处理事件，而是按照事件对象的类型分派给特定的事件处理函数（event handler)。

event()函数主要用于事件的分发：

```c++
bool Widget : :event ( QEvent  e)
{
    if(e->type()==QEvent:MouseButtonPress)
    {
        QMouseEvent*ev=(QMouseEvent*)e;
		mousePressEvent(ev);
    }
    else if(e->type() QEvent: MouseMove)
    {
        QMouseEvent* ev=(QMouseEvent*)e
        mouseMoveEvent(ev);
    }

	return true
}

```

**在产生事件的时候，只需要在子类中重写相关事件的虚函数。**

## 鼠标事件

### 鼠标点击事件和滚轮事件

```c++
virtual void 
mouseMoveEvent(QMouseEvent *event);
virtual void 
mousePressEvent(QMouseEvent *event); 
virtual void 
mouseReleaseEvent(QMouseEvent *event);
virtual void 
mouseDoubleClickEvent(QMouseEvent *event);
virtual void 
wheelEvent(QWheelEvent *event);
```

```c++
#ifndef WIDGET_H
#define WIDGET_H
#include <QWidget>

QT_BEGIN_NAMESPACE
namespace Ui { class Widget; }
QT_END_NAMESPACE

class Widget : public QWidget
{
    Q_OBJECT
public:
    Widget(QWidget *parent = nullptr);
    ~Widget();
protected:
    //重写鼠标事件
    void mousePressEvent(QMouseEvent *event) override;
    void wheelEvent(QWheelEvent *event)override;
private:
    Ui::Widget *ui;
};
#endif // WIDGET_H
```

```c++
#include "widget.h"
#include "ui_widget.h"
#include <QMouseEvent>
#include <QDebug>

Widget::Widget(QWidget *parent)
    : QWidget(parent)
    , ui(new Ui::Widget)
{
    ui->setupUi(this);
}

Widget::~Widget()
{
    delete ui;
}

void Widget::mousePressEvent(QMouseEvent *event)
{
    qDebug()<<"点击了鼠标,坐标("<<event->x()<<","<<event->y()<<")";
    if(event->button() == Qt::LeftButton)
        qDebug()<<"点击了鼠标左键";
    if(event->button() == Qt::RightButton)
        qDebug()<<"点击了鼠标右键";
    if(event->button() == Qt::MidButton)
        qDebug()<<"点击了鼠标中建";
    if(event->button() == Qt::BackButton)
        qDebug()<<"点击了鼠标后键";
    if(event->button() == Qt::TaskButton)
        qDebug()<<"点击了鼠标得到";
}
void Widget::wheelEvent(QWheelEvent *event)
{
    if(event->orientation() == Qt::Vertical)
    {
        qDebug()<<"滚轮"<<event->x()<<","<<event->y();
    }
}
```

## 键盘事件

```c++
virtual void 
keyPressEvent(QKeyEvent *event)
virtual void 
keyReleaseEvent(QKeyEvent *event)
```

```c++
void Widget::keyPressEvent(QWheelEvent *event)
{
    qDebug()<<event->key();
    if(event->modifiers() == Qt::ShiftModifier)
        qDebug()<<"按下shift";
    if(event->modifiers() == Qt::ControlModifier)
        qDebug()<<"按下control";
}
```

## 大小改变事件

```c++
当窗口大小发生变化时被调用，参考代码：
virtual void resizeEvent(QResizeEvent*);//大小改变事件
void Widget::resizeEvent(QResizeEvent*e)
{
	//变化前的窗口大小
	qDebug() < " e-> oldSize( ) = " << e->oldSize();
	//变化后的窗口大小
	qDebug() < " e-> size( ) = " <<e->size();   
}


```



## 进入离开区域事件

```c++
//virtual void enterEvent(QEvent*);//进入事件
//virtual void leaveEvent(QEvent*);//离开事件
//进入事件
void Widget::enterEvent( Q Event)
{
    //
}
void Widget::leaveEvent( Q Event)
{
    //
}
```





