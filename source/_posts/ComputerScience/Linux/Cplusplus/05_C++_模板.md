---
title: 05_C++_æ¨¡æ¿
date: 2022/4/18/ 10:00
categories:
  - è®¡ç®—æœºç§‘å­¦
tags:
  - åµŒå…¥å¼
  - C++è¯­è¨€
  - ç¬”è®°
sticky: true
valine:
  placeholder: "1. æé—®å‰è¯·å…ˆä»”ç»†é˜…è¯»æœ¬æ–‡æ¡£âš¡\n2. é¡µé¢æ˜¾ç¤ºé—®é¢˜ğŸ’¥ï¼Œè¯·æä¾›æ§åˆ¶å°æˆªå›¾ğŸ“¸æˆ–è€…æ‚¨çš„æµ‹è¯•ç½‘å€\n3. å…¶ä»–ä»»ä½•æŠ¥é”™ğŸ’£ï¼Œè¯·æä¾›è¯¦ç»†æè¿°å’Œæˆªå›¾ğŸ“¸ï¼Œç¥é£Ÿç”¨æ„‰å¿«ğŸ’ª"
---



# C++æ¨¡æ¿

## æ¨¡æ¿æ¦‚è®º

c++æä¾›äº†å‡½æ•°æ¨¡æ¿(function template.)ã€‚æ‰€è°“**<u>å‡½æ•°æ¨¡æ¿ï¼Œå®é™…ä¸Šæ˜¯å»ºç«‹ä¸€ä¸ªé€šç”¨å‡½æ•°ï¼Œå…¶å‡½æ•°ç±»å‹å’Œå½¢å‚ç±»å‹ä¸å…·ä½“åˆ¶å®šï¼Œç”¨ä¸€ä¸ªè™šæ‹Ÿçš„ç±»å‹æ¥ä»£è¡¨ï¼Œè¿™ä¸ªé€šç”¨å‡½æ•°å°±æˆä¸ºå‡½æ•°æ¨¡æ¿ã€‚</u>**å‡¡æ˜¯å‡½æ•°ä½“ç›¸åŒçš„å‡½æ•°éƒ½å¯ä»¥ç”¨è¿™ä¸ªæ¨¡æ¿ä»£æ›¿ï¼Œä¸å¿…å®šä¹‰å¤šä¸ªå‡½æ•°ï¼Œåªéœ€åœ¨æ¨¡æ¿ä¸­å®šä¹‰ä¸€æ¬¡å³å¯ã€‚åœ¨è°ƒç”¨å‡½æ•°æ—¶ç³»ç»Ÿä¼šæ ¹æ®å®å‚çš„ç±»å‹æ¥å–ä»£æ¨¡æ¿ä¸­çš„è™šæ‹Ÿç±»å‹ï¼Œä»è€Œå®ç°ä¸åŒå‡½æ•°çš„åŠŸèƒ½ã€‚

c++æä¾›ä¸¤ç§æ¨¡æ¿æœºåˆ¶ï¼šå‡½æ•°æ¨¡æ¿å’Œç±»æ¨¡æ¿

ç±»å±ï¼šç±»å‹å‚æ•°åŒ–ï¼Œåˆç§°å‚æ•°æ¨¡æ¿

æ€»ç»“ï¼š

- :large_orange_diamond:æ¨¡æ¿æŠŠå‡½æ•°æˆ–ç±»è¦å¤„ç†çš„æ•°æ®ç±»å‹å‚æ•°åŒ–ï¼Œè¡¨ç°ä¸ºå‚æ•°çš„å¤šæ€æ€§ï¼Œæˆä¸ºç±»å±ã€‚
- :large_orange_diamond:æ¨¡æ¿ç”¨äºè¡¨è¾¾é€»è¾‘ç»“æ„ç›¸åŒï¼Œä½†å…·ä½“æ•°æ®å…ƒç´ ç±»å‹ä¸åŒçš„æ•°æ®å¯¹è±¡çš„é€šç”¨è¡Œä¸ºã€‚

 >C++æ¨¡æ¿æœ€é‡è¦çš„æŠ€æœ¯ï¼šç±»å‹å‚æ•°åŒ–

## å‡½æ•°æ¨¡æ¿

### å‡½æ•°æ¨¡æ¿çš„å®šä¹‰

```c++
template <class T>//å®šä¹‰ä¸€ä¸ªæ¨¡æ¿ï¼Œæ¨¡æ¿çš„é€šç”¨ç±»å‹T, classå’Œtypenameæ˜¯ä¸€æ ·çš„
//ç´§è·Ÿå‡½æ•°
void swap_temp(T &a, T &b)
{
    T tmp = a;
    a = b;
    b = tmp;
}
void test03()
{
    char a =1;
    char b = 2;
    int c = 3;
    int d = 4;
    swap_temp(a,b);//åˆæ³•
    swap_temp<char>(a,b);//æ˜¾ç¤ºæŒ‡å®šç±»å‹
    swap_temp(b,c);//é”™è¯¯ï¼Œ è‡ªåŠ¨ç±»å‹æ¨å¯¼çš„ç»“æœä¸ä¸€è‡´
    swap_temp(c,d);//åˆæ³•
}

```

### ç»ƒä¹ 

ä½¿ç”¨å‡½æ•°æ¨¡æ¿å®ç°æ•°ç»„æ’åºï¼š

```c++
//å‡½æ•°æ¨¡æ¿ç”¨äºå®ç°æ•°ç»„æ’åº
template <class T>
void array_sort(T *a, int n)
{
    for(int i = 0; i < n-1; ++i)
    {
        for(int j = 1; j < n; ++j)
        {
            if(a[i]>a[j])
            {
                T tmp = a[i];
                a[i] = a[j];
                a[j] = a[i];
            }
        }
    }
}
template <class T>
void print_array(T *p, int n)
{
    for(int i=0; i<n; ++i)
        cout<<p[i]<<" ";
    cout<<endl;
}
void test01()
{
    int a[]={1,6,4,3,77,22,13,456,1,123};
    array_sort(a, sizeof(a)/sizeof(a[0]));
    print_array(a,sizeof(a)/sizeof(a[0]))
}
void test02()
{
    char b[]={'w','t','c','a','q','m','y','0','9'};
    array_sort<char>(a, sizeof(a)/sizeof(a[0]));
    print_array(a,sizeof(a)/sizeof(a[0]))
}
```

### å‡½æ•°æ¨¡æ¿å’Œæ™®é€šå‡½æ•°çš„åŒºåˆ«

:large_orange_diamond:å‡½æ•°æ¨¡æ¿ä¸å…è®¸è‡ªåŠ¨ç±»å‹è½¬æ¢

:large_orange_diamond:æ™®é€šå‡½æ•°èƒ½å¤Ÿè¿›è¡Œç±»å‹è‡ªåŠ¨è½¬æ¢

:large_orange_diamond:è°ƒç”¨æ™®é€šå‡½æ•°ä¸ç”¨æ¨å¯¼

:large_orange_diamond:`Myadd<>(a,a)`æŒ‡å®šæ¨¡æ¿å‡½æ•°è°ƒç”¨

:large_orange_diamond: `Myadd<int>(a,a)`æ˜¾ç¤ºæŒ‡å®šç±»å‹è°ƒç”¨æ¨¡æ¿å‡½æ•°

### å‡½æ•°æ¨¡æ¿å’Œæ™®é€šå‡½æ•°åœ¨ä¸€èµ·è°ƒç”¨çš„è§„åˆ™

:one: C++ç¼–è¯‘å™¨ä¼˜å…ˆè€ƒè™‘æ™®é€šå‡½æ•°

:two: å¯ä»¥é€šè¿‡ç©ºæ¨¡æ¿å®ä¾‹å‚æ•°åˆ—è¡¨çš„è¯­æ³•:label:é™å®šç¼–è¯‘å™¨:computer:åªèƒ½é€šè¿‡å‡½æ•°æ¨¡æ¿åŒ¹é…

:three:å‡½æ•°æ¨¡æ¿å¯ä»¥åƒ æ™®é€šå‡½æ•°ä¸€æ ·è¢«é‡è½½

:four: å¦‚æœå‡½æ•°æ¨¡æ¿å¯ä»¥äº§ç”Ÿä¸€ä¸ªæ›´å¥½çš„åŒ¹é…ï¼Œé‚£ä¹ˆé€‰æ‹©æ¨¡æ¿

## æ¨¡æ¿æœºåˆ¶å‰–æ

:thinking: ä¸ºä»€ä¹ˆæ¨¡æ¿å‡½æ•°å¯ä»¥å’Œæ™®é€šå‡½æ•°æ”¾åœ¨ä¸€èµ·ï¼ŸC++ç¼–è¯‘å™¨æ˜¯å¦‚ä½•å®ç°å‡½æ•°æ¨¡æ¿æœºåˆ¶çš„ï¼Ÿ

### ç¼–è¯‘è¿‡ç¨‹

`hello.cpp`ç¨‹åºæ˜¯é«˜çº§cè¯­è¨€ç¨‹åºï¼Œè¿™ç§ç¨‹åºæ˜“äºè¢«äººè¯»æ‡‚ã€‚ä¸ºäº†åœ¨ç³»ç»Ÿä¸Šè¿è¡Œ`hello.c`ç¨‹åºï¼Œæ¯ä¸€æ¡cè¯­å¥éƒ½å¿…é¡»è½¬åŒ–ä¸ºä½çº§çš„æœºå™¨æŒ‡ä»¤ã€‚ç„¶åå°†è¿™äº›æœºå™¨æŒ‡ä»¤æ‰“åŒ…æˆå¯æ‰§è¡Œç›®æ ‡æ–‡ä»¶æ ¼å¼ï¼Œå¹¶ä»¥äºŒè¿›åˆ¶å½¢å¼å­˜å‚¨äºç£ç›˜ä¸­ã€‚é¢„å¤„ç†(`Pre-processing`):arrow_right:ç¼–è¯‘(`Compiling`):arrow_right:æ±‡ç¼–(`Assembling`):arrow_right:é“¾æ¥(`Linking`)

[![Lri2He.png](https://s1.ax1x.com/2022/04/20/Lri2He.png)](https://imgtu.com/i/Lri2He)

:one:`hello..c`ç»è¿‡é¢„å¤„ç†å™¨ï¼Œå°†å®å±•å¼€ï¼Œç”Ÿæˆçš„æ–‡ä»¶`hello.i`

:two:`hello.i`ç»è¿‡ç¼–è¯‘å™¨ï¼Œå°†æ–‡ä»¶ç¼–è¯‘æˆæ±‡ç¼–è¯­è¨€ï¼Œç”Ÿæˆæ–‡ä»¶ä¸º`hello.s`

:three:`hello.s`ç»è¿‡æ±‡ç¼–å™¨ï¼Œå°†æ–‡ä»¶ç¼–è¯‘æˆç›®æ ‡æ–‡ä»¶`hello.o`(winä¸‹ä¸º`hello.obj`)

:four:`hello.o`ç»è¿‡é“¾æ¥å™¨ï¼Œå°†æ–‡ä»¶ç¼–è¯‘æˆå¯æ‰§è¡Œæ–‡ä»¶

### æ¨¡æ¿å‡½æ•°æœºåˆ¶

:one: ç¼–è¯‘å™¨å¹¶ä¸æ˜¯æŠŠå‡½æ•°æ¨¡æ¿å¤„ç†æˆèƒ½å¤Ÿå¤„ç†ä»»ä½•ç±»å‹çš„å‡½æ•°

:two: å‡½æ•°æ¨¡æ¿é€šè¿‡å…·ä½“ç±»å‹äº§ç”Ÿä¸åŒçš„å‡½æ•°

:three:ç¼–è¯‘å™¨ä¼šå¯¹å‡½æ•°æ¨¡æ¿è¿›è¡Œä¸¤æ¬¡ç¼–è¯‘ï¼Œåœ¨å£°æ˜çš„åœ°æ–¹å¯¹æ¨¡æ¿ä»£ç æœ¬èº«è¿›è¡Œç¼–è¯‘ï¼Œåœ¨è°ƒç”¨çš„åœ°æ–¹å¯¹å‚æ•°æ›¿æ¢åçš„ä»£ç è¿›è¡Œç¼–è¯‘ã€‚

### æ¨¡æ¿å‡½æ•°çš„å±€é™æ€§

ç¼–å†™çš„æ¨¡æ¿å‡½æ•°å¾ˆå¯èƒ½æ— æ³•å¤„ç†æŸäº›ç±»å‹ï¼Œå¦ä¸€æ–¹é¢ï¼Œæœ‰æ—¶å€™é€šç”¨åŒ–æ˜¯æœ‰æ„ä¹‰çš„ï¼Œä½†C++è¯­æ³•ä¸å…è®¸è¿™æ ·åšã€‚ä¸ºäº†è§£å†³è¿™ç§é—®é¢˜ï¼Œå¯ä»¥æä¾›æ¨¡æ¿çš„é‡è½½ï¼Œä¸ºè¿™äº›ç‰¹å®šçš„ç±»å‹æä¾›å…·ä½“åŒ–çš„æ¨¡æ¿ã€‚

å‡½æ•°æ¨¡æ¿å…·ä½“åŒ–è¯­æ³•ï¼š`template<> void mySwap<Person>(Person &p1, Person&p2)`

## ç±»æ¨¡æ¿

### ç±»æ¨¡æ¿è¯­æ³•

```c++
template <class T1, class T2>
class Animal
{
public:
    Animal(T1 a, T2 b):age(a),data(b){}
    T1 age;
    T2 data;

};
void test()
{
    //ç±»æ¨¡æ¿ä¸èƒ½è‡ªåŠ¨ç±»å‹æ¨å¯¼
    Animal<int,int> dog(10,10);//æ˜¾ç¤ºæŒ‡å®š
    Aninmal<int,string> cat(4,"lili");
}
```

### ç±»æ¨¡æ¿ä½œä¸ºå‡½æ•°å‚æ•°

```c++
template <class T1, class T2>
class Animal
{
public:
    Animal(T1 a, T2 b):age(a),data(b){}
    T1 age;
    T2 data;

};
void show(Animal<int,int> &p)
{
    cout<<p.age<<" "<<p.data<<endl;
}
//å‡½æ•°æ¨¡æ¿
template <class T1, class T2>
void show(Animal<T1, T2> &p)
{
     cout<<p.age<<" "<<p.data<<endl;
}
template <class T1>
void show1(T1 &p)
{
    cout<<p.age<<" "<<p.data<<endl;
}
void test()
{
    //ç±»æ¨¡æ¿ä¸èƒ½è‡ªåŠ¨ç±»å‹æ¨å¯¼
    Animal<int,int> dog(10,10);//æ˜¾ç¤ºæŒ‡å®š
    show(dog);
    Aninmal<int,string> cat(4,"lili");
    show(cat);
    show1(cat);
}
```

### ç±»æ¨¡æ¿æ´¾ç”Ÿæ™®é€šç±»

:large_orange_diamond: ç±»æ¨¡æ¿é‡åˆ°ç»§æ‰¿ï¼Œåœ¨ç»§æ‰¿æ—¶ï¼Œç»§æ‰¿çš„ç±»å¿…é¡»æ˜¯ä¸€ä¸ªæ¨¡æ¿ç±»

:large_orange_diamond: ç±»æ¨¡æ¿é‡åˆ°ç»§æ‰¿ï¼Œå¯ä»¥å°†å­ç±»å†™æˆç±»æ¨¡æ¿

```c++
template <class T>
class Base
{
public:
    Base(T a)
    {
        this->a = a;
    }
    T a;
};
//å­ç±»ä¸ºæ™®é€šç±»
class Son1: public Base<int>
{
public:
    Son1(int x1, int a):Base<int>(a),x(x1){}
    int x;
};
//å­ç±»ä¸ºç±»æ¨¡æ¿
template <class T1, class T2>
class Son2: public Base<T2>
{
public:
    Son2(T1 x1, T2 a):Base<T2>(a),x(x1){}
    T1 x;
};
void test01()
{
    Son1 p(10,20);
    Son2 p1(10,"linker");
}

```

### ç±»æ¨¡æ¿æˆå‘˜å‡½æ•°çš„ç±»å†…å®ç°

```c++
template <class T1, class T2>
class Person
{
public:
    Person(T1 a, T2 b)
    {
        this->a = a;
        this->b = b;
    }
    void show()
    {
        cout<<a<<" "<<b<<endl;
    }
    T1 a;
    T2 b;
}
void test()
{
    Person <int, string> p(10, "lili");
    p.show();
}
```

### ç±»æ¨¡æ¿æˆå‘˜å‡½æ•°çš„ç±»å¤–å®ç°

ç±»æ¨¡æ¿æˆå‘˜å‡½æ•°çš„ç±»å¤–å®ç°éœ€è¦<u>å†™æˆå‡½æ•°æ¨¡æ¿</u>

```c++
template <class T1, class T2>
class Person
{
public:
    Person(T1 a, T2 b);
    void show();

    T1 a;
    T2 b;
}
//ç±»å¤–å®ç° éœ€è¦å†™æˆå‡½æ•°æ¨¡æ¿
template <class T1, class T2>
Person<T1, T2>::Person(T1 a, T2 b)
{
    this->a = a;
    this->b = b;
}
template <class T1, class T2>
void Person<T1,T2>::show()
{
    cout<<this->a<<" "<<this->b<<endl;
}
void test()
{
    Person <int, string> p(10, "lili");
    p.show();
}
```

### ç±»æ¨¡æ¿æˆå‘˜å‡½æ•°çš„åˆ›å»ºæœºåˆ¶

ç±»æ¨¡æ¿æˆå‘˜å‡½æ•°æ˜¯åœ¨è°ƒç”¨çš„æ—¶å€™åˆ›å»ºçš„ï¼Œæ²¡æœ‰è°ƒç”¨ç¼–è¯‘å™¨ä¸ä¼šåˆ›å»ºåªæœ‰å£°æ˜ã€‚

```c++
class A
{
public:
    void showA()
    {
        cout<<"class A"<<endl;
    }
};
class B
{
public:
    void showB()
    {
        cout<<"class B"<<endl;
    }
};
template <class T>
class C
{
public:
    void foo1()
    {
        obj.showA();
    }
    void foo2()
    {
        obj.showB();
    }
    T obj;
};
```

### ç±»æ¨¡æ¿å¤´æ–‡ä»¶å’Œæºæ–‡ä»¶åˆ†ç¦»é—®é¢˜

:tonga: ç±»æ¨¡æ¿çš„æ–‡ä»¶ï¼Œå¿…é¡»å°†å‡½æ•°çš„å®šä¹‰å’Œç±»çš„å£°æ˜å†™åˆ°ä¸€ä¸ªæ–‡ä»¶

`Person.h`æ–‡ä»¶ä¸­

```c++
#pragma once
template <class T1, class T2>
class person
{
public:
    person(T1 a, T2 b);
    void show();
    T1 a;
    T2 b;
}
```

`Person.cpp`æ–‡ä»¶ä¸­

```c++
#include "Person.h"
template <class T1, class T2>
person<T1,T2>::person(T1 a, T2 b)
{
    this->a = a;
    this->b = b;
}
template <class T1, class T2>
void person<T1,T2>::show()
{
    cout<<this->a<<" "<<this->b<<endl;
}
```

`main.cpp`æ–‡ä»¶ä¸­

```c++
#include "person.h"
int main()
{
    //è°ƒç”¨æ„é€ å‡½æ•°å’Œshowå‡½æ•°éœ€è¦åˆ›å»ºçš„æ—¶å€™ï¼Œæ— æ³•æ‰¾åˆ°è¿™å†™å‡½æ•°çš„å®šä¹‰
    person<int, int> p(10,20);
    p.show();//æ— æ³•è¿æ¥showå‡½æ•°å®šä¹‰
}
```

**æ­£ç¡®ç”¨æ³•**

ç”¨`.hpp`æ–‡ä»¶å£°æ˜å’Œå®šä¹‰ç±»æ¨¡æ¿

åœ¨`Person.hpp`æ–‡ä»¶ä¸­

```c++
#pragma once
template <class T1, class T2>
class person
{
public:
    person(T1 a, T2 b);
    void show();
    T1 a;
    T2 b;
}
template <class T1, class T2>
person<T1,T2>::person(T1 a, T2 b)
{
    this->a = a;
    this->b = b;
}
template <class T1, class T2>
void person<T1,T2>::show()
{
    cout<<this->a<<" "<<this->b<<endl;
}
```

åœ¨`main.cpp`æ–‡ä»¶ä¸­

```c++
#include "Person.hpp"
int main()
{
    person<int, int> p(10,20);//åˆæ³•
    p.show();//åˆæ³•
}
```

### ç±»æ¨¡æ¿é‡åˆ°å‹å…ƒ

```c++
template <class T1, class T2>
void show_Person(Person<T1,T2>&p);

template <class T1, class T2>
class Person
{
    friend void show_Person<>(Person<T1,T2>&p);
    friend void show_Person1(Person<T1,T2>&p)
    {
        cout<<p.a<<" "<<p.b<<endl;
    }
public:
    Person(T1 a, T2 b)
    {
        this->a = a;
        this->b = b;
    }
private:
    T1 a;
    T2 b;
};
template <class T1, class T2>
void show_Person(Person<T1,T2>&p)
{
    cout<<p.a<<" "<<p.b<<endl;
    
}
void test01()
{
    
}
```



### ç±»æ¨¡æ¿çš„åº”ç”¨

è®¾è®¡ä¸€ä¸ªæ•°ç»„æ¨¡æ¿ç±»(MyArray)ï¼Œå®Œæˆå¯¹ä¸åŒç±»å‹å…ƒç´ çš„ç®¡ç†

```c++
//ç”¨æˆ·æ¥å£
1. æ ¹æ®æŒ‡å®šçš„ä½ç½®æ·»åŠ å…ƒç´ 
2. è·å–æŒ‡å®šä½ç½®çš„å…ƒç´ 
3. å°¾æ’æ³•æ’å…¥æ•°æ® å°¾éƒ¨åˆ é™¤æ•°æ®
4. è·å–æ•°ç»„é•¿åº¦
5. é‡è½½[]æ“ä½œç¬¦
6. é‡å†™æ‹·è´æ„é€ 
template <typename T>
class Array
{
public:
    
private:
    int size;
    int capacity;
    T *ptr;
};
```

