---
title: 4_C_变量的存储类别
date: 2022/4/7/ 8:00
categories:
  - 计算机科学
tags:
  - 嵌入式
  - C语言
  - 笔记
sticky: true
valine:
  placeholder: "1. 提问前请先仔细阅读本文档⚡\n2. 页面显示问题💥，请提供控制台截图📸或者您的测试网址\n3. 其他任何报错💣，请提供详细描述和截图📸，祝食用愉快💪"
---



# 变量的存储类别 

## 内存的分区

1. 内存：存储内存、虚拟内存
   - 物理内存：实实在在的存储设备
   - 虚拟内存：造作系统虚拟出来的内存
   - 操作系统会在物理内存和虚拟内存之间做映射
   - 在32位操作系统下，每个进程的寻址范围是4G，0x00000000~0xffffffff
   - 在写应用程序的时候，我们看到的都是虚拟地址
   - 在32位操作系统中，虚拟内存被分为两个部分，3G的用户空间和1G内核空间，其中用户空间是当前进程所私有的，内核空间，是一个系统中所有的进程所公有的
2. 在运行程序的时候，操作系统会将虚拟内存进行分区
   1. 堆：在动态申请内存的时候，在堆里开辟内存空间
   2. 栈：主要存放局部变量
   3. 静态全局区
      1. 未初始化的静态全局区：静态变量，全局变量，没有初始化，存在此区
      2. 初始化的静态全局区：全局变量、静态变量，赋过初值的，存放在此区
   4. 代码区：存放二进制代码
   5. 文字常量区：存放常量的

## 普通的全局变量

概念：在函数外部定义的变量

```c
int num = 100; // num就是一个全局变量
int main()
{
    return 0;
}
```

作用范围：全局变量的作用范围，是程序的所有地方，只不过用之前需要声明。

声明方法：`exterun int num;`

注意声明的时候，不要赋值

生命周期：在程序运行的整个过程中一直都存在，直到程序结束

注意：定义普通的全局变量的时候，如果不赋初值，它的值默认位0

```c
#include <stdio.h>
//定义一个普通的全局变量
//只要在main函数外（子函数外）的变量，就是全局变量
//如果全局变量没有初始化，则系统默认将其初始化为0
int num;
void func()
{
    num = 888;
}
int main(int argc, char* argv[])
{
    printf("num = %d\n", num);// 打印 0
    func();
    printf("num = %d\n", num);// 打印 888
}
```



## 静态全局变量 static

概念：定义全局变量的时候，前面用static关键字修饰。

```c
static int num=100;//num是一个静态全局变量
int main()
{
    reuturn 0;
}
```

作用范围：static限定了静态全局变量的作用范围，只能在它定义的.c文件(源文件)中有效

生命周期：在程序运行的整个运行过程中，一直存在

注意：定义静态全局变量的时候，如果不赋初值，它的值默认为0

```c
#include <stdio.h>

//定义一个静态全局变量
//只能在定义的.c文件中使用，不能跨文件使用
static int num;

void func()
{
    num++
}
int main(int argc, char *argv[])
{
    printf("num=%d\n",num);//打印 0
    func();
    printf("num=%d\n",num);//打印 1
    
 }
```

## 普通局部变量

概念：在函数内部定义的，或者在复合语句中定义的变量

```c
int main()
{
    int num;//局部变量
    {
        int num;//局部变量，不会与上面的num产生冲突
    }
}
```

作用范围：

​	在函数中定义的变量，在函数中有效，

​	在复合语句中定义的，在复合语句中有效

生命周期：

​	在函数调用之间，局部变量不占用空间，调用函数的时候，才为局部变量开辟内存空间，函数结束，局部变量就释放了。在复合语句中亦是如此。

## 静态的局部变量

概念：定义局部变量的时候，加static关键字进行修饰

作用范围：在它定义的函数或复合语句中有效

生命周期：

​	第一次调用函数的时候，开辟空间赋值，函数结束后，不释放

​	以后再调用函数的时候，就不再为其开辟空间，也不赋初值

​	用的还是之前的那一个变量。

```c
void fun()
{
    static int num=3
        num++;
    printf("num=%d\n",num);
}
int main()
{
    fun();//num = 4
    fun();//num = 5;
    return 0;
}
```

