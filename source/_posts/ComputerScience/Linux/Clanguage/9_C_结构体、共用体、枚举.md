---
title: 9_C_ç»“æ„ä½“ã€å…±ç”¨ä½“ã€æšä¸¾
date: 2022/4/12/ 8:00
categories:
  - è®¡ç®—æœºç§‘å­¦
tags:
  - åµŒå…¥å¼
  - Cè¯­è¨€
  - ç¬”è®°
sticky: true
valine:
  placeholder: "1. æé—®å‰è¯·å…ˆä»”ç»†é˜…è¯»æœ¬æ–‡æ¡£âš¡\n2. é¡µé¢æ˜¾ç¤ºé—®é¢˜ğŸ’¥ï¼Œè¯·æä¾›æ§åˆ¶å°æˆªå›¾ğŸ“¸æˆ–è€…æ‚¨çš„æµ‹è¯•ç½‘å€\n3. å…¶ä»–ä»»ä½•æŠ¥é”™ğŸ’£ï¼Œè¯·æä¾›è¯¦ç»†æè¿°å’Œæˆªå›¾ğŸ“¸ï¼Œç¥é£Ÿç”¨æ„‰å¿«ğŸ’ª"
---



# ç»“æ„ä½“ã€å…±ç”¨ä½“ã€æšä¸¾ 

## ç»“æ„ä½“ç±»å‹çš„æ¦‚å¿µä»¥åŠå®šä¹‰

æ•°ç»„ä¹Ÿæ˜¯ä¸€ç§æ„é€ ç±»å‹

### æ„é€ ç±»å‹

ä¸æ˜¯åŸºæœ¬ç±»å‹çš„æ•°æ®ç»“æ„ä¹Ÿä¸æ˜¯æŒ‡é’ˆï¼Œä»–æ˜¯è‹¥å¹²ä¸ªç›¸åŒæˆ–ä¸åŒç±»å‹çš„æ•°æ®æ„æˆçš„é›†åˆ

æè¿°ä¸€ç»„å…·æœ‰ç›¸åŒç±»å‹æ•°æ®çš„æœ‰åºé›†åˆï¼Œç”¨äºå¤„ç†å¤§ç›¸åŒç±»å‹çš„æ•°æ®è¿ç®—ï¼Œæœ‰æ—¶å€™æˆ‘ä»¬éœ€è¦å°†ä¸åŒç±»å‹çš„æ•°æ®ç»„åˆæˆä¸€ä¸ªæœ‰æœºæ•´ä½“ï¼Œä»¥ä¾¿äºå¼•ç”¨ï¼Œå¦‚ï¼šå­¦ç”Ÿçš„å­¦å·ã€å§“åã€æ€§åˆ«ã€å¹´é¾„ã€å®¶åº­ä½å€ç­‰å±æ€§

å¸¸ç”¨çš„æ„é€ ç±»å‹æœ‰æ•°ç»„ã€ç»“æ„ä½“ã€å…±ç”¨ä½“ã€æšä¸¾

æ•°ç»„ç”¨äºä¿å­˜ç±»å‹ç›¸åŒçš„æ•°æ®ï¼Œç»“æ„ä½“ç”¨äºä¿å­˜ç±»å‹ä¸åŒçš„æ•°æ®

### ç»“æ„ä½“ç±»å‹çš„æ¦‚å¿µ

ç»“æ„ä½“æ˜¯ä¸€ç§æ„é€ ç±»å‹çš„æ•°æ®ç»“æ„ï¼Œæ˜¯ä¸€ç§æˆ–å¤šç§åŸºæœ¬ç±»å‹æˆ–æ„é€ ç±»å‹çš„æ•°æ®çš„é›†åˆ

### ç»“æ„ä½“ç±»å‹çš„å®šä¹‰

ä½¿ç”¨ç»“æ„ä½“ä¹‹å‰å¿…é¡»å…ˆæœ‰ç±»å‹ï¼Œç„¶åç”¨ç±»å‹å®šä¹‰æ•°æ®ç»“æ„ï¼Œè¿™ä¸ªç±»å‹ç›¸å½“äºä¸€ä¸ªæ¨¡å…·ã€‚

1. å…ˆå®šä¹‰ç»“æ„ä½“ç±»å‹ï¼Œå†å»å®šä¹‰ç»“æ„ä½“çš„å˜é‡

   ```c
   struct ç»“æ„ä½“ç±»å‹å{
       æˆå‘˜åˆ—è¡¨
   };
   struct student{
       int num;
       char name[20];
       char sex;
       char addr[32];  
   };
   //æœ‰äº†ç»“æ„ä½“ç±»å‹åï¼Œå°±å¯ä»¥ç”¨ç±»å‹å®šä¹‰å˜é‡
   struct student lucy,bob,lilei;//å®šä¹‰äº†ä¸‰ä¸ªstruct student ç±»å‹çš„å˜é‡ï¼Œæ¯ä¸ªå˜é‡éƒ½æœ‰å››ä¸ªæˆå‘˜ï¼Œåˆ†åˆ«ä¸ºnum name sex addr
   ```

2. åœ¨å®šä¹‰ç»“æ„ä½“ç±»å‹çš„æ—¶å€™é¡ºä¾¿å®šä¹‰ç»“æ„ä½“å˜é‡ï¼Œä»¥åè¿˜å¯ä»¥å®šä¹‰ç»“æ„ä½“å˜é‡

   ```c
   struct ç»“æ„ä½“ç±»å‹å{
   	æˆå‘˜åˆ—è¡¨;
   }ç»“æ„ä½“å˜é‡1ï¼Œå˜é‡2ï¼Œ...;
   struct ç»“æ„ä½“å˜é‡ å˜é‡3ï¼Œå˜é‡4ï¼Œ...;
   
   struct student{
       int num;
       char name[20];
       char sex;
       char addr[32];  
   }lucy, bob, lilei;
   struct student xiaohong, xiaoming;
   ```

   æ³¨æ„ï¼šä¸€èˆ¬ç»“æ„ä½“ç±»å‹éƒ½ä¼šå®šä¹‰åœ¨å…¨å±€ï¼Œä¹Ÿå°±æ˜¯mainå‡½æ•°å¤–é¢ï¼Œæ‰€ä»¥åœ¨å®šä¹‰ç»“æ„ä½“ç±»å‹çš„åŒæ—¶å®šä¹‰å˜é‡ï¼Œè¿™äº›å˜é‡ä¸€èˆ¬éƒ½æ˜¯å…¨å±€å˜é‡ï¼Œå®šä¹‰å®Œç±»å‹ä¹‹åçš„ç»“æ„ä½“å˜é‡å†…å­˜åˆ†é…è¦çœ‹å®šä¹‰çš„ä½ç½®

3. æ— åç»“æ„ä½“çš„å®šä¹‰

   åœ¨å®šä¹‰ç»“æ„ä½“çš„æ—¶å€™ï¼Œæ²¡æœ‰ç»“æ„ä½“ç±»å‹åï¼Œé¡ºä¾¿å®šä¹‰ç»“æ„ä½“å˜é‡ï¼Œç”±äºæ²¡æœ‰ç±»å‹åï¼Œæ‰€ä»¥ä»¥åä¸èƒ½å†å®šä¹‰ç›¸å…³ç±»å‹çš„æ•°æ®

   ```c
   struct {
       æˆå‘˜å˜é‡;
   }å˜é‡1, å˜é‡2, ...;
   ```

   ç”±äºæ— åç»“æ„ä½“æ²¡æœ‰ç±»å‹ï¼Œæ‰€ä»¥åªèƒ½åœ¨å®šä¹‰ç»“æ„ä½“çš„åŒæ—¶å®šä¹‰ç»“æ„ä½“å˜é‡

4. ç»™ç»“æ„ä½“ç±»å‹å–åˆ«å

   é€šå¸¸å°†ä¸€ä¸ªç»“æ„ä½“ç±»å‹é‡æ–°èµ·ä¸€ä¸ªç±»å‹åï¼Œç”¨æ–°çš„ç±»å‹åæ¥æ›¿ä»£åŸæ¥çš„ç±»å‹

   1. å…ˆç”¨ç»“æ„ä½“ç±»å‹å®šä¹‰å˜é‡

      ```c
      stru stu{
          int num;
          char name[20];
          char sex;
      }bob;
      ```

   2. ç”¨æ–°çš„ç±»å‹åæ›¿æ¢å˜é‡å

      ```c
      stru stu{
          int num;
          char name[20];
          char sex;
      }STU;
      ```

   3. åœ¨`struct`çš„å‰é¢ç”¨`typedef`å…³é”®å­—è¿›è¡Œä¿®é¥°

      ```c
      typedef stru stu{
          int num;
          char name[20];
          char sex;
      }STU;
      ```

   `typedef`å…³é”®å­—çš„ä½œç”¨æ˜¯ç»™ä¸€ä¸ªç±»å‹å–åˆ«åï¼Œå¦‚æœç»“æ„ä½“å–åˆ«åï¼Œä¸€èˆ¬ä¸éœ€è¦å…ˆç»™ç»“æ„ä½“å®šä¹‰åå­—ï¼Œå®šä¹‰ç»“æ„ä½“å˜é‡æ—¶ï¼Œç›´æ¥ä½¿ç”¨åˆ«åï¼Œå¯ä»¥ä¸åŠ å…³é”®å­—`struct`

## ç»“æ„ä½“å˜é‡çš„å®šä¹‰åˆå§‹åŒ–åŠä½¿ç”¨

### ç»“æ„ä½“å˜é‡çš„å®šä¹‰å’Œåˆå§‹åŒ–

ç»“æ„ä½“å˜é‡ï¼Œæ˜¯ä¸€ä¸ªå˜é‡ï¼Œè¿™ä¸ªå˜é‡æ˜¯è‹¥å¹²ä¸ªæ•°æ®çš„é›†åˆ

***

1. åœ¨å®šä¹‰ç»“æ„ä½“å˜é‡ä¹‹å‰é¦–å…ˆçš„æœ‰ç»“æ„ä½“ç±»å‹ï¼Œç„¶ååœ¨å®šä¹‰å˜é‡
2. åœ¨å®šä¹‰ç»“æ„ä½“å˜é‡çš„æ—¶å€™ï¼Œå¯ä»¥é¡ºä¾¿ç»™ç»“æ„ä½“å˜é‡èµ‹åˆå€¼ï¼Œç§°ä¸ºç»“æ„ä½“å˜é‡çš„åˆå§‹åŒ–
3. ç»“æ„ä½“å˜é‡åˆå§‹åŒ–çš„æ—¶å€™ï¼Œ**å„ä¸ªæˆå‘˜é¡ºåºåˆå§‹åŒ–**

```c
#include <stdio.h>
#include <string.h>

//å®šä¹‰ç»“æ„ä½“
struct stu{
    int id;
    char name[20];
    char sex;
    int age;
    //å®šäºç»“æ„ä½“å˜é‡ä¹‹å®šä¹‰ç»“æ„ä½“ç±»å‹çš„åŒæ—¶å®šä¹‰ç»“æ„ä½“å˜é‡
}zhangsan,lisi={1002,"æå››","B", 22};

//å¦‚æœåŠ typedefå¯¹ç»“æ„ä½“ç±»å‹å–åˆ«å
typedef struct{
    int a;
    int b;
    char c;
}MSG;
typedef struct{
  int year;
  int month;
  int day;
}BD;
typedef struct{
    int id;
    char name[32];
    BD birth;
}STU;

void test2()
{
    STU xiaoming;
    xiaoming.id = 1001;
    strcpy(xiaoming.name, "å°æ˜");
    //å¦‚æœç»“æ„ä½“ä¸­åµŒå¥—ç»“æ„ä½“ï¼Œèµ‹å€¼æ—¶æ‰¾åˆ°æœ€å†…å±‚çš„æˆå‘˜å†è¿›è¡Œèµ‹å€¼
    xiaoming.birth.year = 2002;
    xiaoming.birth.month = 12;
    xiaoming.birth.day = 20;
    printf("%d - %s - %d:%d:%d\n",xiaoming.id,xiaoming.name,xiaoming.birth.year ,xiaoming.birth.month,xiaoming.birth.day);
    åµŒå¥—çš„å½¢å¼å®šä¹‰å¹¶åˆå§‹åŒ–
    STU xiaoli = {1002,"å°ä¸½",{2000,1,2}};
}

void test1()
{
    //ç±»å‹å®šä¹‰å®Œæ¯•åå®šä¹‰å˜é‡
    struct stu wangwu;
    //ç»“æ„ä½“å˜é‡åˆå§‹åŒ–
    struct stu zhaoliu = {1000,"èµµå…­",'B',20};
    
    //å¦‚æœä½¿ç”¨typedefå¯¹ç»“æ„ä½“ç±»å‹å–åˆ«å
    //å°±æ— æ³•åœ¨å®šä¹‰ç±»å‹çš„æ—¶å€™å®šä¹‰ç»“æ„ä½“å˜é‡
    //åœ¨å®šä¹‰ç»“æ„ä½“å˜é‡çš„æ—¶å€™ä¸ç”¨åŠ struct
    MSG msg1,msg2 = {100,20,'w'};
    
    //ç»“æ„ä½“å˜é‡çš„ä½¿ç”¨
    zhangsan.id = 1001;
    strcpy(zhangsan.name, "å¼ ä¸‰");
    zhangsan.sex = 'B';
    zhangsan.age = 18;
    printf("%d-%s-%c-%d\n",zhangsan.id,zhangsan.name,zhangsan.sex.zhangsan.age);
    printf("%d-%s-%c-%d\n",lisi.id,lisi.name,zlisi.sex.lisi.age);
    printf("%d-%s-%c-%d\n",zhaoliu.id,zhaoliu.name,zhaoliu.sex.zhaoliu.age);

}

int main(int argc, char *argv[])
{
    test1();
    test2();
    return 0;
}
```





### ç»“æ„ä½“å˜é‡çš„ä½¿ç”¨

ç»“æ„ä½“å˜é‡å¯¹æˆå‘˜è°ƒç”¨çš„æ–¹å¼ï¼š`ç»“æ„ä½“å˜é‡.ç»“æ„ä½“æˆå‘˜`

æ³¨æ„ï¼šæ­¤æ—¶çš„ç»“æ„ä½“å˜é‡æ˜¯æ™®é€šçš„ç»“æ„ä½“å˜é‡

## ç›¸åŒç±»å‹çš„ç»“æ„ä½“å˜é‡å¯ä»¥ç›¸äº’èµ‹å€¼

```c
#include <stdio.h>
#include <string.h>

struct stu{
    int id;
    char name[20];
    char sex;
    int age;   
};
int main(int argc, char *argv[])
{
    struct stu zhangsan;
    zhangsan.id = 1001;
    strcpy(zhangsan.name,"å¼ ä¸‰");
    zhangsan.sex = 'B';
    zhangsan.age = 18;
    //ç›¸åŒç±»å‹çš„ç»“æ„ä½“å˜é‡å¯ä»¥ç›¸äº’èµ‹å€¼
    struct stu lisi = zhangsan;
    strcpy(lisi.name, "æå››");
}
```



## ç»“æ„ä½“æ•°ç»„

ç»“æ„ä½“æ•°ç»„æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œç”±è‹¥å¹²ä¸ªç›¸åŒç±»å‹çš„ç»“æ„ä½“å˜é‡æ„æˆçš„é›†åˆ

### ç»“æ„ä½“æ•°ç»„çš„å®šä¹‰

```c
struct ç»“æ„ä½“ç±»å‹å æ•°ç»„å[å…ƒç´ ä¸ªæ•°];
struct stu{
    int num;
    char name[20];
    char sex;
};
struct stu edu[3];//å®šä¹‰äº†ä¸€ä¸ªstruct stuç±»å‹çš„ç»“æ„ä½“æ•°ç»„edu
```

### ç»“æ„ä½“æ•°ç»„å…ƒç´ çš„å¼•ç”¨

`ç»“æ„ä½“æ•°ç»„å[ä¸‹æ ‡]`

### ç»“æ„ä½“æ•°ç»„å…ƒç´ çš„ä½¿ç”¨

```c
edu[0].num = 101;//ç”¨101ç»™eduæ•°ç»„çš„ç¬¬0ä¸ªç»“æ„ä½“å˜é‡çš„numèµ‹å€¼
strcpy(edu[1].name,"lucky");
```

```c
#include <sdtio.h>
#include <string.h>

typedef struct{
	int num;
    char name[32];
    int score;
}STU;
void test()
{
    //å®šä¹‰ä¸€ä¸ªç»“æ„ä½“æ•°ç»„å¹¶åˆå§‹åŒ–
    STU edu[3]={
        {1001, "Bob", 78},
        {1003, "Lucky", 66},
        {1005, "Lucas", 61}
    };
    int i=0;
    for(i;i<3;++i)
        printf("%d - %s - %d", edu[i].num, edu[i].name, edu[i].score);
}
```



## ç»“æ„ä½“æŒ‡é’ˆ

ç»“æ„ä½“æŒ‡é’ˆå³ç»“æ„ä½“çš„åœ°å€ï¼Œç»“æ„ä½“å˜é‡å­˜æ”¾å†…å­˜ä¸­ï¼Œä¹Ÿæœ‰èµ·å§‹åœ°å€ï¼Œå®šä¹‰ä¸€ä¸ªå˜é‡æ¥å­˜æ”¾è¿™ä¸ªåœ°å€ï¼Œé‚£è¿™ä¸ªå˜é‡å°±å«åšç»“æ„ä½“æŒ‡é’ˆå˜é‡ã€‚

### ç»“æ„ä½“æŒ‡é’ˆå˜é‡çš„å®šä¹‰

`struct ç»“æ„ä½“ç±»å‹å *ç»“æ„ä½“æŒ‡é’ˆå˜é‡å;`

### ç»“æ„ä½“æŒ‡é’ˆå˜é‡å¯¹æˆå‘˜çš„å¼•ç”¨

```c
(*ç»“æ„ä½“æŒ‡é’ˆå˜é‡å).æˆå‘˜
ç»“æ„ä½“æŒ‡é’ˆå˜é‡å->æˆå‘˜
```



## ç»“æ„ä½“å†…å­˜åˆ†é…é—®é¢˜

ç»“æ„ä½“å˜é‡å¤§å°æ˜¯å®ƒæ‰€æœ‰æˆå‘˜ä¹‹å’Œï¼Œå› ä¸ºç»“æ„ä½“å˜é‡æ˜¯æ‰€æœ‰æˆå‘˜çš„é›†åˆã€‚

ä½†æ˜¯åœ¨å®é™…ç»™ç»“æ„ä½“å˜é‡åˆ†é…å†…å­˜çš„æ—¶å€™ï¼Œæ˜¯è§„åˆ™çš„

**è§„åˆ™1ï¼šä»¥å¤šå°‘ä¸ªå­—èŠ‚ä¸ºå•ä½å¼€è¾Ÿå†…å­˜**

***

ç»™ç»“æ„ä½“å˜é‡åˆ†é…å†…å­˜çš„æ—¶å€™ï¼Œä¼šå»ç»“æ„ä½“å˜é‡ä¸­æ‰¾åŸºæœ¬ç±»å‹çš„æˆå‘˜ï¼Œå“ªä¸ªåŸºæœ¬ç±»å‹çš„æˆå‘˜å å­—èŠ‚æ•°å¤šï¼Œå°±ä»¥å®ƒçš„å¤§å°ä¸ºå•ä½å¼€è¾Ÿå†…å­˜ã€‚

åœ¨`gcc`ä¸­å‡ºç°`double`ç±»å‹çš„ä¾‹å¤–

1. æˆå‘˜ä¸­åªæœ‰`char`å‹æ•°æ®ï¼Œä»¥1å­—èŠ‚ä¸ºå•ä½å¼€è¾Ÿå†…å­˜ã€‚

2. æˆå‘˜ä¸­å‡ºç°äº†`short int `ç±»å‹æ•°æ®ï¼Œæ²¡æœ‰æ›´å¤§å­—èŠ‚æ•°çš„åŸºæœ¬æ•°æ®ç±»å‹æ•°æ®ï¼Œä»¥2å­—èŠ‚ä¸ºå•ä½å¼€è¾Ÿå†…å­˜

3. å‡ºç°äº†`int` `float`æ²¡æœ‰æ›´å¤§å­—èŠ‚æ•°çš„åŸºæœ¬ç±»å‹æ•°æ®çš„æ—¶å€™ï¼Œä»¥4å­—èŠ‚ä¸ºå•ä½å¼€è¾Ÿå†…å­˜

4. å‡ºç°äº†`double`ç±»å‹çš„æ•°æ®

   1. åœ¨`vc`ä¸­ï¼Œä»¥8å­—èŠ‚ä¸ºå•ä½å¼€è¾Ÿå†…å­˜
   2. åœ¨`gcc`ä¸­ï¼Œä»¥4å­—èŠ‚ä¸ºå•ä½å¼€è¾Ÿå†…å­˜

   æ— è®ºæ˜¯å“ªä¸€ç§ç¯å¢ƒï¼Œ`double`å‹å˜é‡å ç”¨8ä¸ªå­—èŠ‚

> TODO:
>
> å¦‚æœåœ¨ç»“æ„ä½“ä¸­å‡ºç°äº†æ•°ç»„ï¼Œæ•°ç»„å¯ä»¥çœ‹æˆå¤šä¸ªå˜é‡çš„é›†åˆã€‚
>
> å¦‚æœå‡ºç°æŒ‡é’ˆçš„è¯ï¼Œæ²¡æœ‰å å­—èŠ‚æ•°æ›´å¤§çš„ç±»å‹ï¼Œä»¥4å­—èŠ‚ä¸ºå•ä½å¼€è¾Ÿå†…å­˜
>
> åœ¨å†…å­˜ä¸­å­˜å‚¨ç»“æ„ä½“æˆå‘˜çš„æ—¶å€™ï¼ŒæŒ‰å®šä¹‰çš„ç»“æ„ä½“æˆå‘˜é¡ºåºå­˜å‚¨

**è§„åˆ™2ï¼šå­—èŠ‚å¯¹é½**

***

1. `char` 1å­—èŠ‚å¯¹é½ï¼Œå³å­˜æ”¾`char`å‹çš„å˜é‡ï¼Œå†…å­˜å•å…ƒçš„ç¼–å·æ˜¯1çš„å€æ•°å³å¯
2. `short int` 2å­—èŠ‚å¯¹é½ï¼Œå³å­˜æ”¾`short int`å‹çš„å˜é‡ï¼Œèµ·å§‹å†…å­˜å•å…ƒçš„ç¼–å·æ˜¯2çš„å€æ•°å³å¯
3. `int`  4å­—èŠ‚å¯¹é½ï¼Œå³å­˜æ”¾`int`å‹çš„å˜é‡ï¼Œèµ·å§‹å†…å­˜å•å…ƒçš„ç¼–å·æ˜¯4çš„å€æ•°å³å¯
4. `long int`  åœ¨32ä½å¹³å°ä¸‹ï¼Œ4å­—èŠ‚å¯¹é½ï¼Œå³å­˜æ”¾`long int`å‹çš„å˜é‡ï¼Œèµ·å§‹å†…å­˜å•å…ƒçš„ç¼–å·æ˜¯4çš„å€æ•°å³å¯
5. `float`  4å­—èŠ‚å¯¹é½ï¼Œå³å­˜æ”¾`float`å‹çš„å˜é‡ï¼Œèµ·å§‹å†…å­˜å•å…ƒçš„ç¼–å·æ˜¯4çš„å€æ•°å³å¯
6. `double`
   1. `vc`ç¯å¢ƒä¸‹ï¼Œ8å­—èŠ‚å¯¹é½ï¼Œå³å­˜æ”¾`doule`å‹çš„å˜é‡ï¼Œèµ·å§‹å†…å­˜å•å…ƒçš„ç¼–å·æ˜¯8çš„å€æ•°å³å¯ï¼Œ`double`å˜é‡å 8ä¸ªå­—èŠ‚
   2. `gcc`ç¯å¢ƒä¸‹ï¼Œ4å­—èŠ‚å¯¹é½ï¼Œå³å­˜æ”¾`double`å‹çš„å˜é‡ï¼Œèµ·å§‹å†…å­˜å•å…ƒçš„ç¼–å·æ˜¯4çš„å€æ•°å³å¯ï¼Œ`double`å˜é‡å 8ä¸ªå­—èŠ‚

> TODO:
>
> å½“ç»“æ„ä½“æˆå‘˜ä¸­å‡ºç°æ•°ç»„çš„æ—¶å€™ï¼Œå¯ä»¥çœ‹æˆå¤šä¸ªå˜é‡
>
> å¼€è¾Ÿå†…å­˜ç©ºé—´çš„æ—¶å€™ï¼Œä»ä¸Šåˆ°ä¸‹ä¸€æ¬¡æŒ‰ç…§æˆå‘˜åœ¨ç»“æ„ä½“ä¸­çš„ä½ç½®é¡ºåºå¼€è¾Ÿç©ºé—´

**å­—èŠ‚å¯¹é½çš„ä¼˜ç‚¹ï¼šç”¨ç©ºé—´æ¢æ—¶é—´ï¼Œæé«˜cpuè¯»å–æ•°æ®çš„æ•ˆç‡**



**æŒ‡å®šå¯¹é½åŸåˆ™**

ä½¿ç”¨`#program pack`æ”¹å˜é»˜è®¤å¯¹é½è§„åˆ™

æ ¼å¼ï¼š`#program pack (value)\\valueä¸ºæŒ‡å®šå¯¹é½å€¼`

æ³¨æ„ï¼š

1. valueåªèƒ½æ˜¯ï¼š1ã€2ã€4ã€8ç­‰

2. æŒ‡å®šå¯¹é½å€¼ä¸æ•°æ®ç±»å‹å¯¹é½å€¼ç›¸æ¯”å–è¾ƒå°å€¼

   1. ä»¥å¤šå°‘å­—èŠ‚ä¸ºå•ä½å¼€è¾Ÿå†…å­˜

      ç»“æ„ä½“æˆå‘˜ä¸­ï¼Œå å­—èŠ‚æ•°æœ€å¤§çš„ç±»å‹é•¿åº¦å’Œvalueæ¯”è¾ƒï¼Œå–è¾ƒå°å€¼ä¸ºå•ä½å¼€è¾Ÿå†…å­˜

   2. ç»“æ„ä½“æˆå‘˜ä¸­çš„å¯¹é½æ–¹æ³•ï¼Œå„ä¸ªé»˜è®¤çš„å¯¹é½å­—èŠ‚æ•°å’Œvalueç›¸æ¯”å–è¾ƒå°å€¼

## ä½æ®µ

åœ¨ç»“æ„ä½“ä¸­ï¼Œä»¥ä½ä¸ºå•ä½çš„æˆå‘˜ï¼Œç§°ä¹‹ä¸ºä½æ®µï¼ˆä½åŸŸï¼‰

```c
struct packed_data{
    unsigned int a:2;
    unsigned int b:6;
    unsigned int c:4;
    unsigned int d:4;
    unsigned int i;
}data;
```

ä¸èƒ½å¯¹ä½æ®µæˆå‘˜å–åœ°å€

```c
#include<stdio.h>

struct packed_data{
    unsigned int a:2;
    unsigned int b:6;
    unsigned int c:4;
    unsigned int d:4;
    unsigned int i;
}data;
int main()
{
    printf("%d\n",sizeof(data));
     printf("%d\n",&data);
     printf("%d\n",&data.i);
}

```

ä½æ®µæ³¨æ„äº‹é¡¹ï¼š

1. å¯¹äºä½æ®µçš„å¼•ç”¨ï¼š`data.a = 2`ï¼Œèµ‹å€¼æ—¶ï¼Œä¸è¦è¶…å‡ºä½æ®µçš„å®šä¹‰èŒƒå›´ï¼Œä¾‹å¦‚ï¼šæ®µæˆå‘˜aå®šä¹‰ä½2ä½ï¼Œæœ€å¤§å€¼ä½3ï¼Œå³11ï¼Œæ‰€ä»¥data.a = 5; å°±ä¼šå–4çš„ä½ä¸¤ä½è¿›è¡Œèµ‹å€¼101-->01
2. ä½æ®µæˆå‘˜çš„ç±»å‹å¿…é¡»æŒ‡å®šä¸ºæ•´å‹æˆ–å­—ç¬¦å‹
3. ä¸€ä¸ªä½æ®µå¿…é¡»å­˜æ”¾åœ¨ä¸€ä¸ªå­˜å‚¨å•å…ƒä¸­ï¼Œä¸èƒ½è·¨ä¸¤ä¸ªå•å…ƒï¼Œç¬¬ä¸€ä¸ªå•å…ƒç©ºé—´ä¸èƒ½å®¹çº³ä¸‹ä¸€ä¸ªä½æ®µï¼Œåˆ™è¯¥ç©ºé—´ä¸ç”¨ï¼Œè€Œä»ä¸‹ä¸€ä¸ªå•å…ƒèµ·å­˜æ”¾è¯¥ä½æ®µ

**ä½æ®µé•¿åº¦ä¸èƒ½å¤§äºå­˜å‚¨å•å…ƒçš„é•¿åº¦**

1. charå‹ä½æ®µ <=  8ä½
2. short intå‹ä½æ®µ <= 16ä½
3. intå‹ä½æ®µ <=  32ä½
4. long intä½æ®µ <=  32ä½

**å¦‚æœä¸€ä¸ªæ®µæƒ³ä»å¦ä¸€ä¸ªå­˜å‚¨å•å…ƒå¼€å§‹ï¼Œå¯ä»¥è¿™æ ·å®šä¹‰**

```c
unsigned char a:1;
unsigned char b:2;
unsigned char :0;
unsigned char c:3;//ä»ä¸‹ä¸€ä¸ªå•å…ƒå¼€å§‹å­˜å‚¨è¯¥ä½æ®µ
```

ç”±äºç”¨äº†é•¿åº¦ä½0çš„ä½æ®µï¼Œå…¶ä½œç”¨æ˜¯å¼ä¸‹ä¸€ä¸ªä½æ®µä»ä¸‹ä¸€ä¸ªå­˜å‚¨å•å…ƒå¼€å§‹å­˜æ”¾ï¼Œå³å°†aå’Œbå­˜æ”¾åœ¨ä¸€ä¸ªå­˜å‚¨å•å…ƒä¸­ï¼Œè€Œcç”¨å¦ä¸€ä¸ªå­˜å‚¨å•å…ƒå­˜å‚¨ã€‚

**å¯ä»¥å®šä¹‰æ— æ„ä¹‰çš„ä½æ®µ**

```c
unsigned int a:1;
unsigned int :2;//æ­¤ä¸ºæ— æ„ä¹‰çš„ä½æ®µ
unsigned int b:3;
```

## å…±ç”¨ä½“

[![LeGStH.png](https://s1.ax1x.com/2022/04/12/LeGStH.png)](https://imgtu.com/i/LeGStH)
[![Le8v7D.png](https://s1.ax1x.com/2022/04/12/Le8v7D.png)](https://imgtu.com/i/Le8v7D)

## æšä¸¾